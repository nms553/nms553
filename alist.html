
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script
    type="text/javascript"
    src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"
    
  ></script>

    <link rel="stylesheet" type="text/css" href="/css/result-light.css">


  <style id="compiled-css" type="text/css">
      table {
	table-layout: fixed;
}

td {
	vertical-align: top;
}

.strikethru {
	text-decoration: line-through;
}

#saveall {
	width: 200px;
}

p {
	margin: 5px;
}

.yellow {
	background-color: yellow;
}

.green {
	background-color: lime;
}

.pink {
	background-color: magenta;
}
    /* EOS */
  </style>

  <script id="insert"></script>


</head>
<body>
    <div><table border="0" width="90%">
	<tr>
		<td id="col1"></td>
		<td id="col2" contenteditable><ul><li></li></ul></td>
	</tr>
	<tr>
		<td><input type="text" id="add1"><button onclick="add1()">Submit</button></td>
		<!-- <td><input type="text" onchange="add2(this.value)" id="add2"></td> -->
	</tr>
</table>

</div>
<br>
<button onclick="saveAll()" id="saveall">Save All</button>

    <script type="text/javascript">//<![CDATA[


$(document).ready(function() {
  $.getJSON("https://spreadsheets.google.com/feeds/list/1DvaYXhcpPJvMFNDlDtx9oG-YGKfqtT6ZbPWqZIvaIxw/1/public/full?alt=json", function(result) {
    var data = result.feed.entry;
    data.forEach(function(item, index) {
      if (item.gsx$cola.$t == "1") {
        var str = item.gsx$colb.$t;
        var parse = JSON.parse(str);
        $("#col1").html(parse)
				
				var str2 = item.gsx$colc.$t;
        var parse2 = JSON.parse(str2);
        $("#col2").html(parse2)
      }
    });
  });
});

function saveAll() {
  var html = $("#col1").html();
  var str = JSON.stringify(html);
  var iframe = $("<iframe></iframe>").attr("name", "targetiframe").attr("style", "display: none;");
  var form = document.createElement("FORM");
  form.action = "https://script.google.com/macros/s/AKfycbwxE5s7hfAtQXZPLKwdNFpT6J2ThVai8fbweqPwh43VQXdSRTkC/exec";
  form.method = "get";
  form.target = "targetiframe";
  form.style = "display: none;";
  $("body").append(form).append(iframe);
  var timestamp = $("<INPUT>").val("1").attr("name", "row");
  var col = $("<INPUT>").val("colB").attr("name", "col");
  var input = $("<INPUT>").val(str).attr("name", "text");
  var sheetname = $("<INPUT>").val("Test").attr("name", "sheetName");
  $(form).append(timestamp).append(col).append(input).append(sheetname).submit();
saveAll2()
}

function saveAll2() {
  var html = $("#col2").html();
  var str = JSON.stringify(html);
  var iframe = $("<iframe></iframe>").attr("name", "targetiframe").attr("style", "display: none;");
  var form = document.createElement("FORM");
  form.action = "https://script.google.com/macros/s/AKfycbwxE5s7hfAtQXZPLKwdNFpT6J2ThVai8fbweqPwh43VQXdSRTkC/exec";
  form.method = "get";
  form.target = "targetiframe";
  form.style = "display: none;";
  $("body").append(form).append(iframe);
  var timestamp = $("<INPUT>").val("1").attr("name", "row");
  var col = $("<INPUT>").val("colC").attr("name", "col");
  var input = $("<INPUT>").val(str).attr("name", "text");
  var sheetname = $("<INPUT>").val("Test").attr("name", "sheetName");
  $(form).append(timestamp).append(col).append(input).append(sheetname).submit();
}



$("#add1").keydown(function(e) {
  if (e.which == 13) {
    add1()
  }
})

function add1() {
  var x = $("#add1").val()
  var p = $("<p></p>").html(x)
  $("#col1").append(p)
  $("#add1").val("")
  saveAll()
}

$("table").on("dblclick", "p", function() {
  if (this.classList.contains("strikethru")) {
    this.classList.remove("strikethru")
    this.classList.add("yellow")
  } else if (this.classList.contains("yellow")) {
    this.classList.remove("yellow")
    this.classList.add("green")
  } else if (this.classList.contains("green")) {
    this.classList.remove("green")
    this.classList.add("pink")
  } else if (this.classList.contains("pink")) {
    this.classList.remove("pink")
  } else {
    this.classList.add("strikethru")
  }
  saveAll()

})



  //]]></script>

  <script>
    // tell the embed parent frame the height of the content
    if (window.parent && window.parent.parent){
      window.parent.parent.postMessage(["resultsFrame", {
        height: document.body.getBoundingClientRect().height,
        slug: "1bynr67m"
      }], "*")
    }

    // always overwrite window.name, in case users try to set it manually
    window.name = "result"
  </script>


</body>
</html>
