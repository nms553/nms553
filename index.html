
<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
    <link href="https://stupid-fast.com/css.css" rel="stylesheet">

    <style>
      p {
        font-size: 0.83em;
      }
      
      table {
      table-layout: fixed;
      }
      
      tr td:nth-child(2), tr td:nth-child(3) {
      	width: 35%;
      }

    </style>

  </head>

  <body id="body">

    <a href="https://www.stupid-fast.com/" class="banner">
      <img src="https://www.stupid-fast.com/banner.png"></a>

    <center id="links"></center>

    <table class="smalltable">
      <tbody id="tbody">
      </tbody>
    </table>


    <script>
      document.addEventListener("DOMContentLoaded", loadXMLDoc);

      function loadXMLDoc() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            var result = JSON.parse(this.responseText);
            //console.log(result);
            result.forEach(function(item, index) {
              var el = document.createElement(item.tag)
              el.href = item.href
              el.innerText = item.text
              el.className = item.class
              el.target = item.target
              el.style = item.style
              links.appendChild(el)
            })

          };
        }
        xhttp.open(
          "GET",
          "https://script.google.com/macros/s/AKfycbzGvt4ZYQ_N_qKsn5ULfGuanIJLVh6fvLTRM6wE0hsX3a2aWRwP7wuTLXpFQUq_lGDUhw/exec",
          true
        );
        xhttp.send();

        getSummary()
      }

      function getSummary() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            var result = JSON.parse(this.responseText);
            console.log(result);
            var sorted = result.Player.sort(function(a, b) {
              return a.lastweek - b.lastweek
            })
            sorted.forEach(function(item, index) {
              if (item.active !== false) {
                var tr = tbody.insertRow()
                var td1 = tr.insertCell()
                td1.innerHTML = item.player + "&nbsp;<sup>(" + Math.round(item.lastweek) + ")</sup>"
                var td2 = tr.insertCell()
                td2.innerText = item.driver1
                var td3 = tr.insertCell()
                td3.innerText = item.driver2
              }

              if (item.trashtalk) {
                var p = document.createElement("P")
                p.innerHTML = "<i><b>" + item.player + " says</b>â€”<br><blockquote>" + item.trashtalk + "</blockquote>"
                body.appendChild(p) + "</i>"
              }

            })

          };
        }
        xhttp.open(
          "GET",
          "https://script.google.com/macros/s/AKfycbxWY4yfPYawPQlV60bP6pMoZbvW124OZSMf_ftGk3QkUUyuFoDvnClgScK3JXHyu--w/exec",
          true
        );
        xhttp.send();

      }

    </script>


  </body>
  
  <footer>
    <a href="./cardinals">Cards</a>
    
  </footer>

</html>
