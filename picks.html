
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>STUPID_FAST PICKS CURRENT</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script
    type="text/javascript"
    src="/js/lib/dummy.js"
    
  ></script>

    <link rel="stylesheet" type="text/css" href="/css/result-light.css">


  <style id="compiled-css" type="text/css">
          html,
      body {
        //color: white;

      }

      table {
        table-layout: fixed;
        width: 100%;
        max-width: 300px;
        border-spacing: 0px 10px;
      }

      select {
        float: right;
      }
      
      input {
        box-sizing: border-box;
        width: 100%;
      }

    /* EOS */
  </style>

  <script id="insert"></script>

</head>
<body>
    


  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
    <link href="https://stupid-fast.com/css.css" rel="stylesheet">


    <script type="text/javascript" src="/js/lib/dummy.js"></script>

    <link rel="stylesheet" type="text/css" href="/css/result-light.css">

</head>

<body>
  



    <dialog id="dialog">
      <center>
        <p id="p">Submitting...</p>
        <button id="b" onclick="closeModal()">Close</button>
      </center>
    </dialog>


    <center>
      <a href="https://www.stupid-fast.com/">
        <img src="https://www.stupid-fast.com/banner/banner.png">
      </a>

      <br><br>

      <table id="top10"></table>

      <hr>

      <table id="nontop10"></table>

      <br>
      <br>

    </center>
    
    
    <script src="https://stupid-fast.com/gviz.js"></script>

</body>

    <script type="text/javascript">//<![CDATA[




      var key = "1jwadkJYYfBmf-SbjUokDV0S_yzC7gD39-jHxVatJfLU"
      var select = document.createElement("SELECT")
      select.add(document.createElement("OPTION"))

      function getPlayers() {
        gviz(key, "PLAYERS", "select A, B, C where C = true", function(data) {
          console.log(data)
          data.shift()
          data.forEach(function(item) {
            opt = document.createElement("OPTION")
            opt.text = item[1]
            opt.value = item[0]
            select.add(opt)
          })
          console.log(select)
          getDrivers(data)
        })
      }


      function getDrivers(players) {
        gviz(key, "DRIVERS", "select A, B, C, D, F", function(data) {
          data.shift()
          console.log(data)
          var filter = data.filter(function(item) {
          	return item[4] !== "âœ—"
          })
          getStandings(players, filter)
        })

      }


      function getStandings(players, drivers) {
        gviz(key, "DSTANDINGS", "select K", function(data) {
          data.shift()
          console.log(data)
          matchDrivers(players, drivers, data.flat())
        })
      }


      function matchDrivers(players, drivers, standings) {

        drivers.forEach(function(item) {
          var indexof = standings.indexOf(item[0])
          var table = document.getElementById("nontop10")
          if (indexof < 12 && indexof > -1) {
            table = document.getElementById("top10")
          }
          var tr = table.insertRow()
          var trtr = table.insertRow()
          tr.insertCell().innerHTML = item[1]
          var trtd = trtr.insertCell()
          trtd.setAttribute("colspan", 2)
          trtd.classList.add("trashtalk")
          trtd.classList.add(item[0])
          var inp = document.createElement("INPUT")
          inp.placeholder = "trashtalk"
          inp.title = item[0]
          inp.setAttribute("onchange", "submitDriver('trashtalk', this.value, this.title)")
          trtd.style.display = "none"
          trtd.append(inp)
          var td = tr.insertCell()
          var clone = select.cloneNode(true)
          clone.value = item[3]
          clone.id = item[0]
          clone.setAttribute("onchange", "submitDriver('driver', this.value, this.id)")

          td.append(clone)
        })

      }






      getPlayers()



      function submitDriver(type, value, driverid) {
      var tr = document.getElementsByClassName("trashtalk")
      for (let i of tr) {
      	i.style.display = "none"
      }
      document.getElementsByClassName(driverid)[0].style.display = ""
        b.style.visibility = "hidden"
        //dialog.showModal()

        var url = "https://script.google.com/macros/s/AKfycbz-bo8-JCGDorlrhvfS2zYWH_F7p5iwgk2TjxeSWdSZSZPuaS9v42WAidA9lbRaI2qBzg/exec?type=" + type + "&value=" + value + "&driverid=" + driverid
        console.log(url)

        var xhttpx = new XMLHttpRequest();
        xhttpx.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            b.style.visibility = ""
            p.innerHTML = "Success"
          }
        };
        xhttpx.open("GET", url, true);
        xhttpx.send();


      }



      function closeModal() {
        p.innerHTML = "Submitting..."
        dialog.close()
      }








  //]]></script>

  <script>
    // tell the embed parent frame the height of the content
    if (window.parent && window.parent.parent){
      window.parent.parent.postMessage(["resultsFrame", {
        height: document.body.getBoundingClientRect().height,
        slug: "g0av52om"
      }], "*")
    }

    // always overwrite window.name, in case users try to set it manually
    window.name = "result"
  </script>


</body>
</html>
